---
title: "Communications"
author: "Shozen Dan"
date: "9/28/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
library(tidyverse)
```

## Communications
```{r message=FALSE}
house.clean <- read_csv("../../data/cleaned/communication_cleaned.csv")
```

```{r, message=FALSE}
urban.score.comm <- house.clean %>% 
  group_by(year, communityID) %>% 
  summarise(
    prop_telephone = mean(telephone == 1, na.rm = T),
    prop_internet = mean(internet == 1, na.rm = T)
  ) %>% 
  mutate(
    urban_score_comm = 10*(prop_internet)
  ) %>% 
  select(communityID, year, urban_score_comm)
```

## Imputation
```{r}
summary(urban.score.comm$urban_score_comm)
```

```{r}
ggplot(urban.score.comm, aes(x = urban_score_comm, color=factor(year))) + 
  geom_density(size=0.7) + 
 scale_x_continuous(breaks = seq(0,10,1), limits=c(0,10)) +
  labs(
    x = "Score",
    y = "Density"
  ) + 
  ylim(c(0,0.31)) +
  scale_color_manual(values = c("#003f5c", "#7a5195", "#ef5675", "#ffa600")) +
  theme_minimal() + 
  theme(
    legend.title = element_blank(),
    aspect.ratio = 1
  )
```
```{r}
write_csv(urban.score.comm, "../../Scores/Individual/communication.csv")
```



